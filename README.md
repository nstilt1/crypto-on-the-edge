# Crypto on the Edge

This repository houses two libraries that enable the operation of a crypto-system with Edge computing with the following features:
* no need to store private keys
* functions that assist with rotating private keys
* symmetric key generation for resources, such as items in a database

The `key_generator` library offers a way to compute private keys from a "key ID" (using an internal HKDF), as well as validate that the Key ID was likely to be generated by this program (using an internal MAC algorithm). The specific Hash function within the HKDF can be specified as a generic parameter, and the specific MAC algorithm can also be specified. The Key IDs can also contain an expiration timestamp to ensure that old key IDs cannot be used.

The `key_generator` also offers a way to generate "keyless IDs" that can be used to associate with a user or a client. The keyless IDs are embedded with a MAC, and Key IDs can be associated with other IDs to "bind" the key ID to another ID. When a key ID is bound to a client, the private key generation is also affected by the associated ID, so that if two clients' bound key IDs are the same, the private keys will likely be different.

The `key_generator` also contains a versioning mechanism. The versions have associated salts that are generated with `ChaCha`, and the salts are used with the MAC generation and private key generation. This feature is only active when `std` is enabled, but the version salts are *nearly* equivalent to rekeying the MAC and HKDF.

The `key_generator` also provides a way to generate symmetric keys for a database item, which can take inputs such as the table name/id, the client id, or whatever information you want to bind the key to.

The `key_manager` is primarily for an HTTP API, and decrypts requests, encrypts protobuf responses, and signs responses. Verifying signatures must be done separately.

# Compatibility

This library has not yet reached version `0.1.0`, so expect breaking changes until then, and then still expect breaking changes until `1.0.0`. If all goes well, I might make this library `1.0.0` after the following changes:
1) stabile, safe generic parameters with compile-time checks
2) sensible parameter specifications
3) *maybe* a `KDF` trait to allow for different KDFs to be used in `key_generator`, such as `concat_kdf`, `hkdf`, and `ckdf`.

# Security

No crates in this repository have yet received any formal cryptographic and security reviews/audits.

As with every cryptographic program, this can only be as secure as the machines that store the source code and binaries, the machines that the code runs on (including the software running as well as the hardware), as well as the underlying libraries that are used in conjunction with this library.

For the `ChaChaRng`, it should be noted that using `ChaCha20Rng` over `ChaCha8Rng` in the context of the `key_generator` does not necessarily provide extra security. In this instance, most of the RNG's security comes from the security of the seed, and the rest of the security comes from the machine it runs on. So long as the output is uniformly pseudorandom and the seed is secure, more rounds shouldn't affect the security of the RNG.


## License

All crates licensed under either of

 * [Apache License, Version 2.0](http://www.apache.org/licenses/LICENSE-2.0)
 * [MIT license](http://opensource.org/licenses/MIT)

at your option.

### Contribution

Unless you explicitly state otherwise, any contribution intentionally submitted for inclusion in the work by you, as defined in the Apache-2.0 license, shall be dual licensed as above, without any additional terms or conditions.
